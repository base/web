import{u as r,j as e}from"./index-Dlxm52NL.js";/* empty css                                */const t={title:"Node Performance",slug:"/node-performance",description:"Guides on how to improve syncing performance of Base node clients"};function n(i){const s={a:"a",aside:"aside",code:"code",div:"div",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",span:"span",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...r(),...i.components};return e.jsxs(e.Fragment,{children:[e.jsx(s.header,{children:e.jsxs(s.h1,{id:"node-performance",children:["Node Performance",e.jsx(s.a,{"aria-hidden":"true",tabIndex:"-1",href:"#node-performance",children:e.jsx(s.div,{"data-autolink-icon":!0})})]})}),`
`,e.jsx(s.p,{children:"This guide provides recommendations for hardware, client software, and configuration settings to optimize the performance of your Base node."}),`
`,e.jsxs(s.h2,{id:"hardware",children:["Hardware",e.jsx(s.a,{"aria-hidden":"true",tabIndex:"-1",href:"#hardware",children:e.jsx(s.div,{"data-autolink-icon":!0})})]}),`
`,e.jsx(s.p,{children:"Running a performant Base node requires adequate hardware. We recommend the following minimum specifications:"}),`
`,e.jsxs(s.ol,{children:[`
`,e.jsx(s.li,{children:"A modern multi-core CPU with good single-core performance."}),`
`,e.jsx(s.li,{children:"At least 32 GB RAM (64 GB recommended)."}),`
`,e.jsx(s.li,{children:"A locally attached NVMe SSD drive. RAID 0 configurations can improve performance."}),`
`,e.jsxs(s.li,{children:["Sufficient storage capacity calculated as: ",e.jsx(s.code,{children:"(2 * [current chain size](https://base.org/stats) + [snapshot size](https://basechaindata.vercel.app) + 20% buffer)"}),". This accounts for chain data growth and snapshot restoration space."]}),`
`]}),`
`,e.jsx(s.aside,{"data-callout":"info",children:e.jsxs(s.p,{children:["If utilizing Amazon Elastic Block Store (EBS), io2 Block Express volumes are recommended to ensure sufficient disk read speeds, preventing latency issues during initial sync. However, ",e.jsx(s.strong,{children:"locally attached NVMe SSDs are strongly recommended over networked storage for optimal performance."})]})}),`
`,e.jsxs(s.h3,{id:"production-hardware-examples",children:["Production Hardware Examples",e.jsx(s.a,{"aria-hidden":"true",tabIndex:"-1",href:"#production-hardware-examples",children:e.jsx(s.div,{"data-autolink-icon":!0})})]}),`
`,e.jsx(s.p,{children:"The following are the hardware specifications used for Base production nodes:"}),`
`,e.jsxs(s.ul,{children:[`
`,e.jsxs(s.li,{children:[`
`,e.jsx(s.strong,{children:"Geth Full Node:"}),`
`,e.jsxs(s.ul,{children:[`
`,e.jsxs(s.li,{children:["Instance: AWS ",e.jsx(s.code,{children:"i4i.12xlarge"})]}),`
`,e.jsxs(s.li,{children:["Storage: RAID 0 of all local NVMe drives (",e.jsx(s.code,{children:"/dev/nvme*"}),")"]}),`
`,e.jsx(s.li,{children:"Filesystem: ext4"}),`
`]}),`
`]}),`
`,e.jsxs(s.li,{children:[`
`,e.jsx(s.strong,{children:"Reth Archive Node:"}),`
`,e.jsxs(s.ul,{children:[`
`,e.jsxs(s.li,{children:["Instance: AWS ",e.jsx(s.code,{children:"i7ie.6xlarge"})]}),`
`,e.jsxs(s.li,{children:["Storage: RAID 0 of all local NVMe drives (",e.jsx(s.code,{children:"/dev/nvme*"}),")"]}),`
`,e.jsx(s.li,{children:"Filesystem: ext4"}),`
`]}),`
`]}),`
`]}),`
`,e.jsxs(s.h2,{id:"initial-sync",children:["Initial Sync",e.jsx(s.a,{"aria-hidden":"true",tabIndex:"-1",href:"#initial-sync",children:e.jsx(s.div,{"data-autolink-icon":!0})})]}),`
`,e.jsxs(s.p,{children:["Using a recent ",e.jsx(s.a,{href:"/node-snapshots",children:"snapshot"})," can significantly reduce the time required for the initial node synchronization process."]}),`
`,e.jsxs(s.h2,{id:"client-software",children:["Client Software",e.jsx(s.a,{"aria-hidden":"true",tabIndex:"-1",href:"#client-software",children:e.jsx(s.div,{"data-autolink-icon":!0})})]}),`
`,e.jsxs(s.p,{children:["The ",e.jsx(s.a,{href:"https://github.com/base/node",children:"Base Node"})," repository contains the current stable configurations and instructions for running different client implementations."]}),`
`,e.jsxs(s.h3,{id:"supported-clients",children:["Supported Clients",e.jsx(s.a,{"aria-hidden":"true",tabIndex:"-1",href:"#supported-clients",children:e.jsx(s.div,{"data-autolink-icon":!0})})]}),`
`,e.jsxs(s.p,{children:["Reth is currently the most performant client for running Base nodes. Future optimizations will primarily focus on Reth. You can read more about the migration to Reth ",e.jsx(s.a,{href:"https://blog.base.dev/scaling-base-with-reth",children:"here"}),"."]}),`
`,e.jsxs(s.table,{children:[e.jsx(s.thead,{children:e.jsxs(s.tr,{children:[e.jsx(s.th,{style:{textAlign:"left"},children:"Type"}),e.jsx(s.th,{style:{textAlign:"left"},children:"Supported Clients"})]})}),e.jsxs(s.tbody,{children:[e.jsxs(s.tr,{children:[e.jsx(s.td,{style:{textAlign:"left"},children:"Full"}),e.jsxs(s.td,{style:{textAlign:"left"},children:[e.jsx(s.a,{href:"https://github.com/base/node/tree/main/reth",children:"Reth"}),", ",e.jsx(s.a,{href:"https://github.com/base/node/tree/main/geth",children:"Geth"})]})]}),e.jsxs(s.tr,{children:[e.jsx(s.td,{style:{textAlign:"left"},children:"Archive"}),e.jsx(s.td,{style:{textAlign:"left"},children:e.jsx(s.a,{href:"https://github.com/base/node/tree/main/reth",children:"Reth"})})]})]})]}),`
`,e.jsxs(s.h3,{id:"geth-performance-tuning",children:["Geth Performance Tuning",e.jsx(s.a,{"aria-hidden":"true",tabIndex:"-1",href:"#geth-performance-tuning",children:e.jsx(s.div,{"data-autolink-icon":!0})})]}),`
`,e.jsxs(s.h4,{id:"geth-cache-settings",children:["Geth Cache Settings",e.jsx(s.a,{"aria-hidden":"true",tabIndex:"-1",href:"#geth-cache-settings",children:e.jsx(s.div,{"data-autolink-icon":!0})})]}),`
`,e.jsx(s.p,{children:"For Geth nodes, tuning cache allocation via environment variables can improve performance. These settings are used in the standard Docker configuration:"}),`
`,e.jsx(e.Fragment,{children:e.jsx(s.pre,{className:"shiki shiki-themes github-light github-dark",style:{backgroundColor:"#fff","--shiki-dark-bg":"#24292e",color:"#24292e","--shiki-dark":"#e1e4e8"},tabIndex:"0",children:e.jsxs(s.code,{children:[e.jsx(s.span,{className:"line",children:e.jsx(s.span,{style:{color:"#6A737D","--shiki-dark":"#6A737D"},children:"# .env.mainnet / .env.sepolia"})}),`
`,e.jsxs(s.span,{className:"line",children:[e.jsx(s.span,{style:{color:"#24292E","--shiki-dark":"#E1E4E8"},children:"GETH_CACHE"}),e.jsx(s.span,{style:{color:"#D73A49","--shiki-dark":"#F97583"},children:"="}),e.jsx(s.span,{style:{color:"#032F62","--shiki-dark":"#9ECBFF"},children:'"20480"'}),e.jsx(s.span,{style:{color:"#6A737D","--shiki-dark":"#6A737D"},children:" # Total P2P cache memory allowance (MB) (default: 1024)"})]}),`
`,e.jsxs(s.span,{className:"line",children:[e.jsx(s.span,{style:{color:"#24292E","--shiki-dark":"#E1E4E8"},children:"GETH_CACHE_DATABASE"}),e.jsx(s.span,{style:{color:"#D73A49","--shiki-dark":"#F97583"},children:"="}),e.jsx(s.span,{style:{color:"#032F62","--shiki-dark":"#9ECBFF"},children:'"20"'}),e.jsx(s.span,{style:{color:"#6A737D","--shiki-dark":"#6A737D"},children:" # Percentage of cache memory allowance for database io (default: 75)"})]}),`
`,e.jsxs(s.span,{className:"line",children:[e.jsx(s.span,{style:{color:"#24292E","--shiki-dark":"#E1E4E8"},children:"GETH_CACHE_GC"}),e.jsx(s.span,{style:{color:"#D73A49","--shiki-dark":"#F97583"},children:"="}),e.jsx(s.span,{style:{color:"#032F62","--shiki-dark":"#9ECBFF"},children:'"12"'}),e.jsx(s.span,{style:{color:"#6A737D","--shiki-dark":"#6A737D"},children:" # Percentage of cache memory allowance for garbage collection (default: 25)"})]}),`
`,e.jsxs(s.span,{className:"line",children:[e.jsx(s.span,{style:{color:"#24292E","--shiki-dark":"#E1E4E8"},children:"GETH_CACHE_SNAPSHOT"}),e.jsx(s.span,{style:{color:"#D73A49","--shiki-dark":"#F97583"},children:"="}),e.jsx(s.span,{style:{color:"#032F62","--shiki-dark":"#9ECBFF"},children:'"24"'}),e.jsx(s.span,{style:{color:"#6A737D","--shiki-dark":"#6A737D"},children:" # Percentage of cache memory allowance for snapshot caching (default: 10)"})]}),`
`,e.jsxs(s.span,{className:"line",children:[e.jsx(s.span,{style:{color:"#24292E","--shiki-dark":"#E1E4E8"},children:"GETH_CACHE_TRIE"}),e.jsx(s.span,{style:{color:"#D73A49","--shiki-dark":"#F97583"},children:"="}),e.jsx(s.span,{style:{color:"#032F62","--shiki-dark":"#9ECBFF"},children:'"44"'}),e.jsx(s.span,{style:{color:"#6A737D","--shiki-dark":"#6A737D"},children:" # Percentage of cache memory allowance for trie caching (default: 25)"})]})]})})}),`
`,e.jsxs(s.h4,{id:"geth-leveldb-tuning",children:["Geth LevelDB Tuning",e.jsx(s.a,{"aria-hidden":"true",tabIndex:"-1",href:"#geth-leveldb-tuning",children:e.jsx(s.div,{"data-autolink-icon":!0})})]}),`
`,e.jsx(s.p,{children:"For teams running Geth with LevelDB, the following patch allows setting LevelDB initialization parameters via environment variables:"}),`
`,e.jsx(s.p,{children:e.jsx(s.a,{href:"https://github.com/0x00101010/goleveldb/commit/55ef3429673fb70d389d052a15a4423e13d8b43c",children:"https://github.com/0x00101010/goleveldb/commit/55ef34"})}),`
`,e.jsxs(s.p,{children:["This patch can be applied using a ",e.jsx(s.code,{children:"replace"})," directive in ",e.jsx(s.code,{children:"go.mod"})," when building ",e.jsx(s.code,{children:"op-geth"}),". Here's how to modify the Dockerfile:"]}),`
`,e.jsx(e.Fragment,{children:e.jsx(s.pre,{className:"shiki shiki-themes github-light github-dark has-diff",style:{backgroundColor:"#fff","--shiki-dark-bg":"#24292e",color:"#24292e","--shiki-dark":"#e1e4e8"},tabIndex:"0",children:e.jsxs(s.code,{children:[e.jsxs(s.span,{className:"line",children:[e.jsx(s.span,{style:{color:"#D73A49","--shiki-dark":"#F97583"},children:"RUN"}),e.jsx(s.span,{style:{color:"#24292E","--shiki-dark":"#E1E4E8"},children:" git clone $REPO --branch $VERSION --single-branch . && \\"})]}),`
`,e.jsx(s.span,{className:"line",children:e.jsx(s.span,{style:{color:"#24292E","--shiki-dark":"#E1E4E8"},children:"    git switch -c branch-$VERSION $COMMIT && \\"})}),`
`,e.jsxs(s.span,{className:"line",children:[e.jsx(s.span,{style:{color:"#24292E","--shiki-dark":"#E1E4E8"},children:"    bash -c "}),e.jsx(s.span,{style:{color:"#032F62","--shiki-dark":"#9ECBFF"},children:`'[ "$(git rev-parse HEAD)" = "$COMMIT" ]'`})]}),`
`,e.jsx(s.span,{className:"line","data-empty-line":!0,children:" "}),`
`,e.jsxs(s.span,{className:"line diff add",children:[e.jsx(s.span,{style:{color:"#D73A49","--shiki-dark":"#F97583"},children:"RUN"}),e.jsx(s.span,{style:{color:"#24292E","--shiki-dark":"#E1E4E8"},children:" echo "}),e.jsx(s.span,{style:{color:"#032F62","--shiki-dark":"#9ECBFF"},children:"''"}),e.jsx(s.span,{style:{color:"#24292E","--shiki-dark":"#E1E4E8"},children:" >> go.mod && "}),e.jsx(s.span,{style:{color:"#005CC5","--shiki-dark":"#79B8FF"},children:"\\ "})]}),`
`,e.jsxs(s.span,{className:"line diff add",children:[e.jsx(s.span,{style:{color:"#24292E","--shiki-dark":"#E1E4E8"},children:"    echo "}),e.jsx(s.span,{style:{color:"#032F62","--shiki-dark":"#9ECBFF"},children:"'replace github.com/syndtr/goleveldb => github.com/0x00101010/goleveldb v1.0.4-param-customization'"}),e.jsx(s.span,{style:{color:"#24292E","--shiki-dark":"#E1E4E8"},children:" >> go.mod && "}),e.jsx(s.span,{style:{color:"#005CC5","--shiki-dark":"#79B8FF"},children:"\\ "})]}),`
`,e.jsxs(s.span,{className:"line diff add",children:[e.jsx(s.span,{style:{color:"#24292E","--shiki-dark":"#E1E4E8"},children:"    go mod tidy "}),e.jsx(s.span,{style:{color:"#005CC5","--shiki-dark":"#79B8FF"},children:"\\ "})]}),`
`,e.jsx(s.span,{className:"line","data-empty-line":!0,children:" "}),`
`,e.jsx(s.span,{className:"line",children:e.jsx(s.span,{style:{color:"#6A737D","--shiki-dark":"#6A737D"},children:"# Continue building op-geth"})}),`
`,e.jsxs(s.span,{className:"line",children:[e.jsx(s.span,{style:{color:"#D73A49","--shiki-dark":"#F97583"},children:"COPY"}),e.jsx(s.span,{style:{color:"#24292E","--shiki-dark":"#E1E4E8"},children:" op-geth/ ./"})]}),`
`,e.jsxs(s.span,{className:"line",children:[e.jsx(s.span,{style:{color:"#D73A49","--shiki-dark":"#F97583"},children:"RUN"}),e.jsx(s.span,{style:{color:"#24292E","--shiki-dark":"#E1E4E8"},children:" go run build/ci.go install -static ./cmd/geth"})]})]})})}),`
`,e.jsx(s.p,{children:"Recommended LevelDB environment variable values with this patch:"}),`
`,e.jsx(e.Fragment,{children:e.jsx(s.pre,{className:"shiki shiki-themes github-light github-dark",style:{backgroundColor:"#fff","--shiki-dark-bg":"#24292e",color:"#24292e","--shiki-dark":"#e1e4e8"},tabIndex:"0",children:e.jsxs(s.code,{children:[e.jsx(s.span,{className:"line",children:e.jsx(s.span,{style:{color:"#6A737D","--shiki-dark":"#6A737D"},children:"# Recommended LevelDB Settings"})}),`
`,e.jsxs(s.span,{className:"line",children:[e.jsx(s.span,{style:{color:"#24292E","--shiki-dark":"#E1E4E8"},children:"LDB_BLOCK_SIZE"}),e.jsx(s.span,{style:{color:"#D73A49","--shiki-dark":"#F97583"},children:"="}),e.jsx(s.span,{style:{color:"#032F62","--shiki-dark":"#9ECBFF"},children:'"16384"'}),e.jsx(s.span,{style:{color:"#6A737D","--shiki-dark":"#6A737D"},children:" # 16 KiB block size"})]}),`
`,e.jsxs(s.span,{className:"line",children:[e.jsx(s.span,{style:{color:"#24292E","--shiki-dark":"#E1E4E8"},children:"LDB_COMPACTION_TABLE_SIZE"}),e.jsx(s.span,{style:{color:"#D73A49","--shiki-dark":"#F97583"},children:"="}),e.jsx(s.span,{style:{color:"#032F62","--shiki-dark":"#9ECBFF"},children:'"8388608"'}),e.jsx(s.span,{style:{color:"#6A737D","--shiki-dark":"#6A737D"},children:" # 8 MiB compaction table size (default: 2 MiB)"})]}),`
`,e.jsxs(s.span,{className:"line",children:[e.jsx(s.span,{style:{color:"#24292E","--shiki-dark":"#E1E4E8"},children:"LDB_COMPACTION_TOTAL_SIZE"}),e.jsx(s.span,{style:{color:"#D73A49","--shiki-dark":"#F97583"},children:"="}),e.jsx(s.span,{style:{color:"#032F62","--shiki-dark":"#9ECBFF"},children:'"41943040"'}),e.jsx(s.span,{style:{color:"#6A737D","--shiki-dark":"#6A737D"},children:" # 40 MiB total compaction size (default: 8 MiB)"})]}),`
`,e.jsxs(s.span,{className:"line",children:[e.jsx(s.span,{style:{color:"#24292E","--shiki-dark":"#E1E4E8"},children:"LDB_DEBUG_OPTIONS"}),e.jsx(s.span,{style:{color:"#D73A49","--shiki-dark":"#F97583"},children:"="}),e.jsx(s.span,{style:{color:"#032F62","--shiki-dark":"#9ECBFF"},children:'"1"'}),e.jsx(s.span,{style:{color:"#6A737D","--shiki-dark":"#6A737D"},children:" # Emit LevelDB debug logs"})]})]})})})]})}function d(i={}){const{wrapper:s}={...r(),...i.components};return s?e.jsx(s,{...i,children:e.jsx(n,{...i})}):n(i)}export{d as default,t as frontmatter};

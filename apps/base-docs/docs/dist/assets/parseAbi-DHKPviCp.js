const F="1.0.8";class c extends Error{constructor(t,r={}){var i;const a=r.cause instanceof c?r.cause.details:(i=r.cause)!=null&&i.message?r.cause.message:r.details,n=r.cause instanceof c&&r.cause.docsPath||r.docsPath,s=[t||"An error occurred.","",...r.metaMessages?[...r.metaMessages,""]:[],...n?[`Docs: https://abitype.dev${n}`]:[],...a?[`Details: ${a}`]:[],`Version: abitype@${F}`].join(`
`);super(s),Object.defineProperty(this,"details",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docsPath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metaMessages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shortMessage",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"AbiTypeError"}),r.cause&&(this.cause=r.cause),this.details=a,this.docsPath=n,this.metaMessages=r.metaMessages,this.shortMessage=t}}function d(e,t){const r=e.exec(t);return r==null?void 0:r.groups}const E=/^bytes([1-9]|1[0-9]|2[0-9]|3[0-2])?$/,k=/^u?int(8|16|24|32|40|48|56|64|72|80|88|96|104|112|120|128|136|144|152|160|168|176|184|192|200|208|216|224|232|240|248|256)?$/,I=/^\(.+?\).*?$/,A=/^tuple(?<array>(\[(\d*)\])*)$/;function M(e){let t=e.type;if(A.test(e.type)&&"components"in e){t="(";const r=e.components.length;for(let n=0;n<r;n++){const s=e.components[n];t+=M(s),n<r-1&&(t+=", ")}const a=d(A,e.type);return t+=`)${(a==null?void 0:a.array)??""}`,M({...e,type:t})}return"indexed"in e&&e.indexed&&(t=`${t} indexed`),e.name?`${t} ${e.name}`:t}function $(e){let t="";const r=e.length;for(let a=0;a<r;a++){const n=e[a];t+=M(n),a!==r-1&&(t+=", ")}return t}function Ae(e){var t;return e.type==="function"?`function ${e.name}(${$(e.inputs)})${e.stateMutability&&e.stateMutability!=="nonpayable"?` ${e.stateMutability}`:""}${(t=e.outputs)!=null&&t.length?` returns (${$(e.outputs)})`:""}`:e.type==="event"?`event ${e.name}(${$(e.inputs)})`:e.type==="error"?`error ${e.name}(${$(e.inputs)})`:e.type==="constructor"?`constructor(${$(e.inputs)})${e.stateMutability==="payable"?" payable":""}`:e.type==="fallback"?`fallback() external${e.stateMutability==="payable"?" payable":""}`:"receive() external payable"}const O=/^error (?<name>[a-zA-Z$_][a-zA-Z0-9$_]*)\((?<parameters>.*?)\)$/;function B(e){return O.test(e)}function K(e){return d(O,e)}const j=/^event (?<name>[a-zA-Z$_][a-zA-Z0-9$_]*)\((?<parameters>.*?)\)$/;function L(e){return j.test(e)}function D(e){return d(j,e)}const R=/^function (?<name>[a-zA-Z$_][a-zA-Z0-9$_]*)\((?<parameters>.*?)\)(?: (?<scope>external|public{1}))?(?: (?<stateMutability>pure|view|nonpayable|payable{1}))?(?: returns\s?\((?<returns>.*?)\))?$/;function N(e){return R.test(e)}function W(e){return d(R,e)}const T=/^struct (?<name>[a-zA-Z$_][a-zA-Z0-9$_]*) \{(?<properties>.*?)\}$/;function z(e){return T.test(e)}function J(e){return d(T,e)}const _=/^constructor\((?<parameters>.*?)\)(?:\s(?<stateMutability>payable{1}))?$/;function V(e){return _.test(e)}function q(e){return d(_,e)}const Z=/^fallback\(\) external(?:\s(?<stateMutability>payable{1}))?$/;function G(e){return Z.test(e)}function H(e){return d(Z,e)}const Q=/^receive\(\) external payable$/;function X(e){return Q.test(e)}const Y=new Set(["indexed"]),P=new Set(["calldata","memory","storage"]);class Ee extends c{constructor({signature:t}){super("Failed to parse ABI item.",{details:`parseAbiItem(${JSON.stringify(t,null,2)})`,docsPath:"/api/human#parseabiitem-1"}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"InvalidAbiItemError"})}}class ee extends c{constructor({type:t}){super("Unknown type.",{metaMessages:[`Type "${t}" is not a valid ABI type. Perhaps you forgot to include a struct signature?`]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"UnknownTypeError"})}}class te extends c{constructor({type:t}){super("Unknown type.",{metaMessages:[`Type "${t}" is not a valid ABI type.`]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"UnknownSolidityTypeError"})}}class re extends c{constructor({param:t}){super("Invalid ABI parameter.",{details:t}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"InvalidParameterError"})}}class ne extends c{constructor({param:t,name:r}){super("Invalid ABI parameter.",{details:t,metaMessages:[`"${r}" is a protected Solidity keyword. More info: https://docs.soliditylang.org/en/latest/cheatsheet.html`]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"SolidityProtectedKeywordError"})}}class ae extends c{constructor({param:t,type:r,modifier:a}){super("Invalid ABI parameter.",{details:t,metaMessages:[`Modifier "${a}" not allowed${r?` in "${r}" type`:""}.`]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"InvalidModifierError"})}}class ie extends c{constructor({param:t,type:r,modifier:a}){super("Invalid ABI parameter.",{details:t,metaMessages:[`Modifier "${a}" not allowed${r?` in "${r}" type`:""}.`,`Data location can only be specified for array, struct, or mapping types, but "${a}" was given.`]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"InvalidFunctionModifierError"})}}class se extends c{constructor({abiParameter:t}){super("Invalid ABI parameter.",{details:JSON.stringify(t,null,2),metaMessages:["ABI parameter type is invalid."]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"InvalidAbiTypeParameterError"})}}class h extends c{constructor({signature:t,type:r}){super(`Invalid ${r} signature.`,{details:t}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"InvalidSignatureError"})}}class oe extends c{constructor({signature:t}){super("Unknown signature.",{details:t}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"UnknownSignatureError"})}}class ue extends c{constructor({signature:t}){super("Invalid struct signature.",{details:t,metaMessages:["No properties exist."]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"InvalidStructSignatureError"})}}class ce extends c{constructor({type:t}){super("Circular reference detected.",{metaMessages:[`Struct "${t}" is a circular reference.`]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"CircularReferenceError"})}}class le extends c{constructor({current:t,depth:r}){super("Unbalanced parentheses.",{metaMessages:[`"${t.trim()}" has too many ${r>0?"opening":"closing"} parentheses.`],details:`Depth "${r}"`}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"InvalidParenthesisError"})}}function pe(e,t,r){let a="";if(r)for(const n of Object.entries(r)){if(!n)continue;let s="";for(const i of n[1])s+=`[${i.type}${i.name?`:${i.name}`:""}]`;a+=`(${n[0]}{${s}})`}return t?`${t}:${e}${a}`:e}const S=new Map([["address",{type:"address"}],["bool",{type:"bool"}],["bytes",{type:"bytes"}],["bytes32",{type:"bytes32"}],["int",{type:"int256"}],["int256",{type:"int256"}],["string",{type:"string"}],["uint",{type:"uint256"}],["uint8",{type:"uint8"}],["uint16",{type:"uint16"}],["uint24",{type:"uint24"}],["uint32",{type:"uint32"}],["uint64",{type:"uint64"}],["uint96",{type:"uint96"}],["uint112",{type:"uint112"}],["uint160",{type:"uint160"}],["uint192",{type:"uint192"}],["uint256",{type:"uint256"}],["address owner",{type:"address",name:"owner"}],["address to",{type:"address",name:"to"}],["bool approved",{type:"bool",name:"approved"}],["bytes _data",{type:"bytes",name:"_data"}],["bytes data",{type:"bytes",name:"data"}],["bytes signature",{type:"bytes",name:"signature"}],["bytes32 hash",{type:"bytes32",name:"hash"}],["bytes32 r",{type:"bytes32",name:"r"}],["bytes32 root",{type:"bytes32",name:"root"}],["bytes32 s",{type:"bytes32",name:"s"}],["string name",{type:"string",name:"name"}],["string symbol",{type:"string",name:"symbol"}],["string tokenURI",{type:"string",name:"tokenURI"}],["uint tokenId",{type:"uint256",name:"tokenId"}],["uint8 v",{type:"uint8",name:"v"}],["uint256 balance",{type:"uint256",name:"balance"}],["uint256 tokenId",{type:"uint256",name:"tokenId"}],["uint256 value",{type:"uint256",name:"value"}],["event:address indexed from",{type:"address",name:"from",indexed:!0}],["event:address indexed to",{type:"address",name:"to",indexed:!0}],["event:uint indexed tokenId",{type:"uint256",name:"tokenId",indexed:!0}],["event:uint256 indexed tokenId",{type:"uint256",name:"tokenId",indexed:!0}]]);function ye(e,t={}){if(N(e))return de(e,t);if(L(e))return fe(e,t);if(B(e))return me(e,t);if(V(e))return be(e,t);if(G(e))return he(e);if(X(e))return{type:"receive",stateMutability:"payable"};throw new oe({signature:e})}function de(e,t={}){const r=W(e);if(!r)throw new h({signature:e,type:"function"});const a=y(r.parameters),n=[],s=a.length;for(let o=0;o<s;o++)n.push(f(a[o],{modifiers:P,structs:t,type:"function"}));const i=[];if(r.returns){const o=y(r.returns),u=o.length;for(let p=0;p<u;p++)i.push(f(o[p],{modifiers:P,structs:t,type:"function"}))}return{name:r.name,type:"function",stateMutability:r.stateMutability??"nonpayable",inputs:n,outputs:i}}function fe(e,t={}){const r=D(e);if(!r)throw new h({signature:e,type:"event"});const a=y(r.parameters),n=[],s=a.length;for(let i=0;i<s;i++)n.push(f(a[i],{modifiers:Y,structs:t,type:"event"}));return{name:r.name,type:"event",inputs:n}}function me(e,t={}){const r=K(e);if(!r)throw new h({signature:e,type:"error"});const a=y(r.parameters),n=[],s=a.length;for(let i=0;i<s;i++)n.push(f(a[i],{structs:t,type:"error"}));return{name:r.name,type:"error",inputs:n}}function be(e,t={}){const r=q(e);if(!r)throw new h({signature:e,type:"constructor"});const a=y(r.parameters),n=[],s=a.length;for(let i=0;i<s;i++)n.push(f(a[i],{structs:t,type:"constructor"}));return{type:"constructor",stateMutability:r.stateMutability??"nonpayable",inputs:n}}function he(e){const t=H(e);if(!t)throw new h({signature:e,type:"fallback"});return{type:"fallback",stateMutability:t.stateMutability??"nonpayable"}}const ge=/^(?<type>[a-zA-Z$_][a-zA-Z0-9$_]*)(?<array>(?:\[\d*?\])+?)?(?:\s(?<modifier>calldata|indexed|memory|storage{1}))?(?:\s(?<name>[a-zA-Z$_][a-zA-Z0-9$_]*))?$/,$e=/^\((?<type>.+?)\)(?<array>(?:\[\d*?\])+?)?(?:\s(?<modifier>calldata|indexed|memory|storage{1}))?(?:\s(?<name>[a-zA-Z$_][a-zA-Z0-9$_]*))?$/,ve=/^u?int$/;function f(e,t){var m,b;const r=pe(e,t==null?void 0:t.type,t==null?void 0:t.structs);if(S.has(r))return S.get(r);const a=I.test(e),n=d(a?$e:ge,e);if(!n)throw new re({param:e});if(n.name&&xe(n.name))throw new ne({param:e,name:n.name});const s=n.name?{name:n.name}:{},i=n.modifier==="indexed"?{indexed:!0}:{},o=(t==null?void 0:t.structs)??{};let u,p={};if(a){u="tuple";const v=y(n.type),g=[],w=v.length;for(let x=0;x<w;x++)g.push(f(v[x],{structs:o}));p={components:g}}else if(n.type in o)u="tuple",p={components:o[n.type]};else if(ve.test(n.type))u=`${n.type}256`;else if(u=n.type,(t==null?void 0:t.type)!=="struct"&&!U(u))throw new te({type:u});if(n.modifier){if(!((b=(m=t==null?void 0:t.modifiers)==null?void 0:m.has)!=null&&b.call(m,n.modifier)))throw new ae({param:e,type:t==null?void 0:t.type,modifier:n.modifier});if(P.has(n.modifier)&&!Se(u,!!n.array))throw new ie({param:e,type:t==null?void 0:t.type,modifier:n.modifier})}const l={type:`${u}${n.array??""}`,...s,...i,...p};return S.set(r,l),l}function y(e,t=[],r="",a=0){const n=e.trim().length;for(let s=0;s<n;s++){const i=e[s],o=e.slice(s+1);switch(i){case",":return a===0?y(o,[...t,r.trim()]):y(o,t,`${r}${i}`,a);case"(":return y(o,t,`${r}${i}`,a+1);case")":return y(o,t,`${r}${i}`,a-1);default:return y(o,t,`${r}${i}`,a)}}if(r==="")return t;if(a!==0)throw new le({current:r,depth:a});return t.push(r.trim()),t}function U(e){return e==="address"||e==="bool"||e==="function"||e==="string"||E.test(e)||k.test(e)}const we=/^(?:after|alias|anonymous|apply|auto|byte|calldata|case|catch|constant|copyof|default|defined|error|event|external|false|final|function|immutable|implements|in|indexed|inline|internal|let|mapping|match|memory|mutable|null|of|override|partial|private|promise|public|pure|reference|relocatable|return|returns|sizeof|static|storage|struct|super|supports|switch|this|true|try|typedef|typeof|var|view|virtual)$/;function xe(e){return e==="address"||e==="bool"||e==="function"||e==="string"||e==="tuple"||E.test(e)||k.test(e)||we.test(e)}function Se(e,t){return t||e==="bytes"||e==="string"||e==="tuple"}function Me(e){const t={},r=e.length;for(let i=0;i<r;i++){const o=e[i];if(!z(o))continue;const u=J(o);if(!u)throw new h({signature:o,type:"struct"});const p=u.properties.split(";"),l=[],m=p.length;for(let b=0;b<m;b++){const g=p[b].trim();if(!g)continue;const w=f(g,{type:"struct"});l.push(w)}if(!l.length)throw new ue({signature:o});t[u.name]=l}const a={},n=Object.entries(t),s=n.length;for(let i=0;i<s;i++){const[o,u]=n[i];a[o]=C(u,t)}return a}const Pe=/^(?<type>[a-zA-Z$_][a-zA-Z0-9$_]*)(?<array>(?:\[\d*?\])+?)?$/;function C(e,t,r=new Set){const a=[],n=e.length;for(let s=0;s<n;s++){const i=e[s];if(I.test(i.type))a.push(i);else{const u=d(Pe,i.type);if(!(u!=null&&u.type))throw new se({abiParameter:i});const{array:p,type:l}=u;if(l in t){if(r.has(l))throw new ce({type:l});a.push({...i,type:`tuple${p??""}`,components:C(t[l]??[],t,new Set([...r,l]))})}else if(U(l))a.push(i);else throw new ee({type:l})}}return a}function ke(e){const t=Me(e),r=[],a=e.length;for(let n=0;n<a;n++){const s=e[n];z(s)||r.push(ye(s,t))}return r}export{Ee as I,Me as a,ke as b,Ae as f,z as i,ye as p};
